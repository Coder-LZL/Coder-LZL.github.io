import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,o as a,d as l}from"./app-CHHD3Urj.js";const n={},h=l(`<h4 id="在-element-ui-的-el-upload-组件中-通过直接操作内部的-uploadfiles-数组并调用-submit-方法-能够实现重新上传文件的功能。下面解释这个过程的原理和具体步骤" tabindex="-1"><a class="header-anchor" href="#在-element-ui-的-el-upload-组件中-通过直接操作内部的-uploadfiles-数组并调用-submit-方法-能够实现重新上传文件的功能。下面解释这个过程的原理和具体步骤"><span>在 Element UI 的 el-upload 组件中，通过直接操作内部的 uploadFiles 数组并调用 submit 方法，能够实现重新上传文件的功能。下面解释这个过程的原理和具体步骤：</span></a></h4><h3 id="_1-原理" tabindex="-1"><a class="header-anchor" href="#_1-原理"><span>1.原理</span></a></h3><ul><li>访问组件实例：this.$refs.upload 获取到的是 el-upload 组件的实例。这个实例包含了组件的所有方法和属性。</li><li>uploadFiles 数组：el-upload 组件内部维护了一个 uploadFiles 数组，用于存储当前正在上传的文件及其状态。</li><li>创建新文件对象：使用 JavaScript 的 File 构造函数创建一个新的 File 对象，并设置必要的属性（例如文件名、类型、大小、UID等）。</li><li>将新文件添加到 uploadFiles：通过向 uploadFiles 数组中推入新创建的文件对象，手动告诉 el-upload 组件这个文件需要被上传。</li><li>调用 submit 方法：submit 方法触发文件上传操作，它会遍历 uploadFiles 数组中状态为 ready 的文件并进行上传。</li></ul><h3 id="_2-具体步骤" tabindex="-1"><a class="header-anchor" href="#_2-具体步骤"><span>2.具体步骤</span></a></h3><div class="language-javascript line-numbers-mode" data-highlighter="shiki" data-ext="javascript" data-title="javascript" style="--shiki-light:#24292e;--shiki-dark:#abb2bf;--shiki-light-bg:#fff;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes github-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">1.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">获取组件实例</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> uploadComponent</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">$refs</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">upload</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">2.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">创建新的</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> 对象</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">：</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> newFile</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;"> File</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fileItem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">raw</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fileItem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, { </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fileItem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">raw</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;"> });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">3.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">设置文件的</span><span style="--shiki-light:#005CC5;--shiki-dark:#E5C07B;"> UID</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">：</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">newFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">uid</span><span style="--shiki-light:#D73A49;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;"> fileItem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">uid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">4.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">将新文件对象推入</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> uploadFiles</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> 数组</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">：</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">uploadComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">uploadFiles</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  raw</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">newFile</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  name</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fileItem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">fileName</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fileItem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  status</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#98C379;">&#39;ready&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">, ---</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">关键</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  percentage</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">  uid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">fileItem</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">uid</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">});</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">5.</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;">调用</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> submit</span><span style="--shiki-light:#24292E;--shiki-dark:#E06C75;"> 方法</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">：</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E5C07B;">uploadComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#61AFEF;">submit</span><span style="--shiki-light:#24292E;--shiki-dark:#ABB2BF;">();</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-工作原理" tabindex="-1"><a class="header-anchor" href="#_3-工作原理"><span>3.工作原理</span></a></h3><ul><li>添加到 uploadFiles：通过将文件添加到 uploadFiles 数组中，el-upload 组件会将文件视为需要上传的文件。</li><li>调用 submit：submit 方法会遍历 uploadFiles 数组，找到状态为 ready 的文件，并开始上传这些文件。</li></ul><h6 id="通过这种方式-虽然没有直接调用-upload-方法-但通过操作-uploadfiles-数组并调用-submit-方法-成功实现了重新上传文件的功能。这种方法利用了-el-upload-组件内部的文件处理机制-确保文件能够正确地被重新上传。" tabindex="-1"><a class="header-anchor" href="#通过这种方式-虽然没有直接调用-upload-方法-但通过操作-uploadfiles-数组并调用-submit-方法-成功实现了重新上传文件的功能。这种方法利用了-el-upload-组件内部的文件处理机制-确保文件能够正确地被重新上传。"><span>通过这种方式，虽然没有直接调用 upload 方法，但通过操作 uploadFiles 数组并调用 submit 方法，成功实现了重新上传文件的功能。这种方法利用了 el-upload 组件内部的文件处理机制，确保文件能够正确地被重新上传。</span></a></h6>`,8),e=[h];function k(p,t){return a(),s("div",null,e)}const B=i(n,[["render",k],["__file","el-upload.html.vue"]]),E=JSON.parse('{"path":"/element-ui/el-upload.html","title":"el-upload文件上传失败-实现文件重新上传","lang":"zh-CN","frontmatter":{"lang":"zh-CN","title":"el-upload文件上传失败-实现文件重新上传","description":"el-upload文件上传失败-实现文件重新上传"},"headers":[{"level":3,"title":"1.原理","slug":"_1-原理","link":"#_1-原理","children":[]},{"level":3,"title":"2.具体步骤","slug":"_2-具体步骤","link":"#_2-具体步骤","children":[]},{"level":3,"title":"3.工作原理","slug":"_3-工作原理","link":"#_3-工作原理","children":[]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"readingTime":{"minutes":1.71,"words":512},"filePathRelative":"element-ui/el-upload.md"}');export{B as comp,E as data};
